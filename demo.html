<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<script language="javascript" src="./LodopFuncs.js"></script>
<script>
  function CreatePrintPage () {
    var LODOP //声明为全局变量
    LODOP = getLodop()
    LODOP.PRINT_INIT('打印控件功能演示_Lodop功能_测试页一')
    LODOP.ADD_PRINT_RECT(77, 74, 409, 345, 0, 2)
    LODOP.ADD_PRINT_ELLIPSE(351, 140, 140, 60, 0, 1)
    LODOP.ADD_PRINT_RECT(299, 133, 344, 42, 1, 1)
    LODOP.ADD_PRINT_TEXT(91, 242, 70, 21, '测试页标题')
    LODOP.ADD_PRINT_TEXT(201, 94, 20, 94, '测试页内容')
    LODOP.ADD_PRINT_TEXT(129, 131, 345, 31, '测试内容一:9号宋体字是默认字体')
    LODOP.ADD_PRINT_TEXT(161, 131, 345, 31, '测试内容二:11号普通宋体字正体')
    LODOP.SET_PRINT_STYLEA(0, 'FontSize', 11)
    LODOP.ADD_PRINT_TEXT(193, 131, 345, 31, '测试内容三:13.5 号宋体字的粗体')
    LODOP.SET_PRINT_STYLEA(0, 'FontSize', 13.5)
    LODOP.SET_PRINT_STYLEA(0, 'Bold', 1)
    LODOP.ADD_PRINT_TEXT(225, 131, 345, 31, '测试内容四:15号宋体字的斜体')
    LODOP.SET_PRINT_STYLEA(0, 'FontSize', 15)
    LODOP.SET_PRINT_STYLEA(0, 'Italic', 1)
    LODOP.ADD_PRINT_TEXT(260, 131, 345, 31, '测试内容五:16号斜体字带下划线')
    LODOP.SET_PRINT_STYLEA(0, 'FontSize', 16)
    LODOP.SET_PRINT_STYLEA(0, 'Italic', 1)
    LODOP.SET_PRINT_STYLEA(0, 'Underline', 1)
    LODOP.ADD_PRINT_TEXT(308, 144, 318, 29, '测试内容六:黑体字居中')
    LODOP.SET_PRINT_STYLEA(0, 'FontName', '黑体')
    LODOP.SET_PRINT_STYLEA(0, 'FontSize', 13)
    LODOP.SET_PRINT_STYLEA(0, 'Alignment', 2)
    LODOP.ADD_PRINT_TEXT(350, 300, 170, 66, '测试内容七:单行文字右靠齐超出区域宽度时则折行显示')
    LODOP.SET_PRINT_STYLEA(0, 'FontSize', 11)
    LODOP.SET_PRINT_STYLEA(0, 'Alignment', 3)
    LODOP.ADD_PRINT_TEXT(428, 79, 400, 23, '以上演示了位置、区域、字体、图形、线型等打印布局和风格。')
    LODOP.ADD_PRINT_LINE(119, 76, 118, 481, 0, 1)
    LODOP.ADD_PRINT_LINE(78, 127, 420, 128, 0, 1)
    LODOP.ADD_PRINT_LINE(79, 76, 118, 127, 0, 1)
  }

  function PrintByPrinterIndex () {
    CreatePrintPage()
    //LODOP.SET_PRINT_MODE("TRYLINKPRINTER_NOALERT",true);//这个语句设置网络共享打印机连接不通时是否提示一下
    if (LODOP.SET_PRINTER_INDEX(0))
      LODOP.PRINT()
  }
</script>
<body>
<button onclick="PrintByPrinterIndex()">click to print</button>
</body>
</html>